<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AR.js Image Tracking</title>
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
    <script src="https://cdn.rawgit.com/jeromeetienne/AR.js/master/aframe/build/aframe-ar.js"></script>
    <style>
      body { margin: 0; }
      canvas { display: block; }
    </style>
  </head>
  <body>
    <a-scene embedded arjs='trackingMethod: best; sourceType: webcam;'>
      <!-- Replace 'your-image-target.png' with the path to your custom image -->
      <a-image 
        id="imageTarget" 
        src="qrcode_with_logo.png" 
        position="0 0 0" 
        rotation="-90 0 0" 
        scale="1 1 1" 
        visible="false">
      </a-image>

      <a-marker type="pattern" url="pattern.patt">
        <a-gltf-model 
          id="model" 
          src="https://wedding3dmodel.s3.eu-north-1.amazonaws.com/OG.glb" 
          scale="0.5 0.5 0.5" 
          animation-mixer>
        </a-gltf-model>
      </a-marker>

      <a-entity camera></a-entity>
    </a-scene>

    <script>
      const model = document.getElementById('model');
      const imageTarget = document.getElementById('imageTarget');

      // Rotate the model on mouse/touch drag
      let isDragging = false;
      let startX, startY;

      // Event listeners for mouse and touch
      window.addEventListener('mousedown', (event) => {
        startX = event.clientX;
        startY = event.clientY;
        isDragging = true;
      });

      window.addEventListener('mousemove', (event) => {
        if (isDragging) {
          const deltaX = event.clientX - startX;
          const deltaY = event.clientY - startY;

          // Rotate the model based on mouse movement
          model.object3D.rotation.y += deltaX * 0.01; // Rotate left/right
          model.object3D.rotation.x -= deltaY * 0.01; // Rotate up/down

          startX = event.clientX;
          startY = event.clientY;
        }
      });

      window.addEventListener('mouseup', () => {
        isDragging = false;
      });

      // Touch support for mobile
      window.addEventListener('touchstart', (event) => {
        startX = event.touches[0].clientX;
        startY = event.touches[0].clientY;
        isDragging = true;
      });

      window.addEventListener('touchmove', (event) => {
        if (isDragging) {
          const deltaX = event.touches[0].clientX - startX;
          const deltaY = event.touches[0].clientY - startY;

          // Rotate the model based on touch movement
          model.object3D.rotation.y += deltaX * 0.01; // Rotate left/right
          model.object3D.rotation.x -= deltaY * 0.01; // Rotate up/down

          startX = event.touches[0].clientX;
          startY = event.touches[0].clientY;
        }
      });

      window.addEventListener('touchend', () => {
        isDragging = false;
      });
    </script>
  </body>
</html>
